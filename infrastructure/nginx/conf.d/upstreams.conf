# Upstream server configurations for load balancing
# Multiple instances can be added for each service

# Frontend (Angular Development Server)
upstream frontend {
    least_conn;
    server 127.0.0.1:4200 max_fails=3 fail_timeout=30s;
    # Add more frontend instances here:
    # server 127.0.0.1:4201 max_fails=3 fail_timeout=30s backup;
    keepalive 32;
}

# API Gateway (Spring Cloud Gateway)
upstream api_gateway {
    least_conn;
    server 127.0.0.1:8082 max_fails=3 fail_timeout=30s;
    # Add more gateway instances here:
    # server 127.0.0.1:8083 max_fails=3 fail_timeout=30s;
    # server 127.0.0.1:8084 max_fails=3 fail_timeout=30s;
    keepalive 32;
}

# Auth Service (Direct access)
upstream auth_service {
    least_conn;
    server 127.0.0.1:8081 max_fails=3 fail_timeout=30s;
    # Add more auth service instances here:
    # server 127.0.0.1:8085 max_fails=3 fail_timeout=30s;
    keepalive 16;
}

# Eureka Service Discovery
upstream eureka_service {
    least_conn;
    server 127.0.0.1:8761 max_fails=3 fail_timeout=30s;
    # Add more eureka instances here:
    # server 127.0.0.1:8762 max_fails=3 fail_timeout=30s;
    keepalive 8;
}

# Config Server
upstream config_service {
    least_conn;
    server 127.0.0.1:8888 max_fails=3 fail_timeout=30s;
    # Add more config server instances here:
    # server 127.0.0.1:8889 max_fails=3 fail_timeout=30s;
    keepalive 8;
}